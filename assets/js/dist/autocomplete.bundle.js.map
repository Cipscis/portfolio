{"version":3,"sources":["webpack://@cipscis/portfolio/./node_modules/@cipscis/pubsub/dist/pubsub.js","webpack://@cipscis/portfolio/./node_modules/@cipscis/debounce/dist/debounce.js","webpack://@cipscis/portfolio/./app/assets/js/src/status/status.js","webpack://@cipscis/portfolio/./node_modules/@cipscis/activate/dist/activate.js","webpack://@cipscis/portfolio/./app/assets/js/src/autocomplete/autocomplete.js","webpack://@cipscis/portfolio/./app/assets/js/src/autocomplete/example.js"],"names":["subscriptions","split","eventString","filter","str","publish","event","args","events","length","call","this","forEach","callback","apply","subscribe","callbacks","includes","push","debounce","dataAttributes","Types","SUCCESS","ERROR","classes","hidden","module","_initSubscriptions","success","error","hide","_getEl","$status","document","querySelector","NodeList","console","_clearType","type","cssClass","classList","contains","remove","_setType","window","setTimeout","add","_clearMessage","textContent","_setMessage","message","_show","autohideDelay","_setAutohide","_clearAutohide","autohideTimeout","setAttribute","getAttribute","clearTimeout","removeAttribute","fn","delay","timeout","promise","res","scheduleResolution","resolve","undefined","Promise","reject","boundEvents","Map","_activator","elements","activator","querySelectorAll","e","DOMException","_deactivateSingle","HTMLElement","element","_activateSingle","TypeError","_getElementBindings","addEventListener","HTMLButtonElement","_getElementHasBindings","_preventSpacebarScroll","spacebarFn","_isSpacebar","_makeSpacebarFn","bindings","HTMLAnchorElement","enterFn","key","toLowerCase","_isEnter","_makeEnterFn","elementB","get","set","fnB","Object","assign","_rememberElementBindings","removeEventListener","delete","_forgetElementBindings","has","isButton","isInput","HTMLInputElement","HTMLTextAreaElement","isSpacebar","preventDefault","templayed","activate","selectors","visible","$el","style","getComputedStyle","visibility","display","init","_initEl","$wrapper","closest","_initEvents","_onUnfocus","_onFocus","_hideResultsOnEsc","$input","_inputEvent","_selectResultOnEnter","_changeResultFocus","_doQuery","url","val","value","request","XMLHttpRequest","data","query","onload","status","response","JSON","parse","_querySuccess","_queryError","open","setRequestHeader","send","stringify","_clearResults","_buildResults","_setResults","_showResults","$results","template","_getTemplate","innerHTML","resultsHtml","_buildResultsHtml","_bindResultEvents","replace","$resultItems","el","_selectResultEvent","_hideResults","trim","numResults","_removeResultFocus","target","inFocus","activeElement","$focusedResult","_getFocusEl","_selectResult","$focus","resultsVisible","hasResults","$template","templateId","getElementById","$result","Array","prototype","find","matches","focusOnInput","focus","offset","altKey","newIndex","indexOf","_setResultFocus","$focusEl","focusDescendantId"],"mappings":"mBAAA,MAAMA,EAAgB,GAEhBC,EAASC,GAAgBA,EAAYD,MAAM,OAAOE,QAAOC,KAASA,IAClEC,EAAU,SAAUC,KAAUC,GAChC,MAAMC,EAASP,EAAMK,GACrB,GAAIE,EAAOC,OAAS,EAChB,IAAK,MAAMH,KAASE,EAChBH,EAAQK,KAAKC,KAAML,KAAUC,QAG5BD,KAASN,GACIA,EAAcM,GACtBM,SAASC,IACfA,EAASC,MAAM,KAAMP,OAI3BQ,EAAY,SAAUT,EAAOO,GAC/B,MAAML,EAASP,EAAMK,GACrB,GAAIE,EAAOC,OAAS,EAChB,IAAK,MAAMH,KAASE,EAChBO,EAAUT,EAAOO,OAGpB,CACKP,KAASN,IACXA,EAAcM,GAAS,IAE3B,MAAMU,EAAYhB,EAAcM,IAEK,IAAjCU,EAAUC,SAASJ,IACnBG,EAAUE,KAAKL,KCfrBM,GCZS,SAAWJ,GACzB,MAIMK,EACK,wBASLC,EAAQ,CACbC,QAAS,UACTC,MAAO,SAGFC,EAAU,CACf,CAACH,EAAMC,SAAU,UACjB,CAACD,EAAME,OAAQ,QAEfE,OAAQ,UAOHC,EAAS,CACdC,mBAAoB,WACfZ,IACHA,EAxBO,kBAwBmBW,EAAOE,SACjCb,EAxBK,gBAwBmBW,EAAOG,OAC/Bd,EAxBI,eAwBmBW,EAAOI,QAIhCC,OAAQ,SAAUC,GAajB,MAZuB,iBAAZA,EACVA,EAAUC,SAASC,cAAcF,GACvBA,aAAmBG,SAC7BH,EAAUA,EAAQ,QACW,IAAZA,IACjBA,EAAUC,SAASC,cA5Cb,eA+CFF,GACJI,QAAQP,MAAM,oCAGRG,GAGRK,WAAY,SAAUL,GACrB,IAAK,IAAIM,KAAQjB,EAAO,CACvB,IAAIkB,EAAWf,EAAQc,GAEnBN,EAAQQ,UAAUC,SAASF,IAC9BP,EAAQQ,UAAUE,OAAOH,KAK5BI,SAAU,SAAUL,EAAMN,GACzB,IAAIO,EAAWf,EAAQc,GAElBC,GAKLb,EAAOW,WAAWL,GAIlBY,OAAOC,YAAW,IAAMb,EAAQQ,UAAUM,IAAIP,IAAW,KARxDH,QAAQP,MAAM,2CAA6CS,IAW7DS,cAAe,SAAUf,GACxBA,EAAQgB,YAAc,IAGvBC,YAAa,SAAUC,EAASlB,GAC/BN,EAAOqB,cAAcf,GAMrBY,OAAOC,YAAW,IAAMb,EAAQgB,YAAcE,GA/DlC,MAkEbC,MAAO,SAAUD,EAASZ,EAAMN,EAASoB,GACxC1B,EAAOiB,SAASL,EAAMN,GACtBN,EAAOuB,YAAYC,EAASlB,GAE5BA,EAAQQ,UAAUE,OAAOlB,EAAQC,QAEjCC,EAAO2B,aAAarB,EAASoB,IAG9BC,aAAc,SAAUrB,EAASoB,GAGhC,GAFA1B,EAAO4B,eAAetB,GAElBoB,GAAiBA,EAAgB,EAAG,CACvC,IAAIG,EAAkBX,OAAOC,YAAW,IAAMnB,EAAOI,KAAKE,IAAUoB,GACpEpB,EAAQwB,aAAapC,EAAyBmC,KAIhDD,eAAgB,SAAUtB,GACzB,IAAIuB,EAAkBvB,EAAQyB,aAAarC,GAEvCmC,IACHX,OAAOc,aAAaH,GACpBvB,EAAQ2B,gBAAgBvC,KAI1BU,KAAM,SAAUE,IACfA,EAAUN,EAAOK,OAAOC,IAEhBQ,UAAUM,IAAItB,EAAQC,QAC9BC,EAAO4B,eAAetB,IAGvBJ,QAAS,SAAUsB,EAASlB,EAASoB,GACpCpB,EAAUN,EAAOK,OAAOC,GAExBN,EAAOyB,MAAMD,EAAS7B,EAAMC,QAASU,EAASoB,IAG/CvB,MAAO,SAAUqB,EAASlB,EAASoB,GAClCpB,EAAUN,EAAOK,OAAOC,GAExBN,EAAOyB,MAAMD,EAAS7B,EAAME,MAAOS,EAASoB,KAI9C1B,EAAOC,qBAGAD,EAAOI,KACJJ,EAAOE,QACTF,EAAOG,MAnJD,CAqJZd,GDzIc,SAAU6C,EAAIC,GAK3B,IAAIC,EACAC,EACAC,EACJ,OAAO,YAAazD,GAChB,MAAM0D,EAAsBC,IACpBJ,GACAJ,aAAaI,GAEjBA,EAAUjB,YAAW,KACjBiB,OAAUK,EACVJ,OAAUI,EACVH,OAAMG,EACND,EAAQN,EAAG9C,MAAMH,KAAMJ,MACxBsD,IAaP,OAXIG,EACAC,EAAmBD,GAGnBD,EAAU,IAAIK,SAAQ,CAACF,EAASG,KAC5BL,EAAME,EACND,EAAmBD,MAKpBD,KE/CTO,EAAc,IAAIC,IAUxB,SAASC,EAAWC,EAAUb,EAAIc,GAG9B,GAAwB,iBAAbD,EACP,IACIA,EAAWxC,SAAS0C,iBAAiBF,GAEzC,MAAOG,GAEH,MAAM,IAAIC,aAAa,GADRH,IAAcI,EAAoB,aAAe,wEAC8BL,MAGlGA,aAAoBM,YACpBL,EAAUD,EAAUb,GAGpBa,EAAS7D,SAASoE,GAAYN,EAAUM,EAASpB,KAWzD,SAASqB,EAAgBD,EAASpB,GAC9B,KAAMoB,aAAmBD,aACrB,MAAM,IAAIG,UAAU,8DAExB,KAAIC,EAAoBH,EAASpB,KAKjCoB,EAAQI,iBAAiB,QAASxB,GAG5BoB,aAAmBK,oBAAoB,EACD,IAApCC,EAAuBN,IAIvBA,EAAQI,iBAAiB,UAAWG,GAExC,MAAMC,EA4Jd,SAAyB5B,GACrB,OAAO,SAAUgB,GAEb,GADmBa,EAAYb,GAE3B,OAAOhB,EAAGlD,KAAKC,KAAMiE,IAhKNc,CAAgB9B,GACnCoB,EAAQI,iBAAiB,QAASI,GAClC,MAAMG,EAAW,CACbH,cAGJ,KAAMR,aAAmBY,mBAAoB,CAIzC,MAAMC,EA0GlB,SAAsBjC,GAClB,OAAO,SAAUgB,GAEb,GAYR,SAAkBA,GAEd,SADmBA,EAAEkB,KAAgC,UAAxBlB,EAAEkB,IAAIC,eAdfC,CAASpB,GAErB,OAAOhB,EAAGlD,KAAKC,KAAMiE,IA9GLqB,CAAarC,GAC7BoB,EAAQI,iBAAiB,UAAWS,GACpCF,EAASE,QAAUA,GAmD/B,SAAkCb,EAASpB,EAAI+B,GAC3C,IAAIO,EAAW5B,EAAY6B,IAAInB,GAC1BkB,IACDA,EAAW,IAAI3B,IAAI,CAAC,CAACX,EAAI+B,KACzBrB,EAAY8B,IAAIpB,EAASkB,IAE7B,IAAIG,EAAMH,EAASC,IAAIvC,GACnByC,EACAC,OAAOC,OAAOF,EAAKV,IAGnBU,EAAMC,OAAOC,OAAO,GAAIZ,GACxBO,EAASE,IAAIxC,EAAIyC,IA7DjBG,CAAyBxB,EAASpB,EAAI+B,IAW9C,SAASb,EAAkBE,EAASpB,GAChC,KAAMoB,aAAmBD,aACrB,MAAM,IAAIG,UAAU,gEAGxBF,EAAQyB,oBAAoB,QAAS7C,GACrC,MAAM+B,EAAWR,EAAoBH,EAASpB,GACzC+B,IAMCX,aAAmBK,oBACjBM,EAASH,YACTR,EAAQyB,oBAAoB,QAASd,EAASH,YAI5CR,aAAmBY,mBACjBD,EAASE,SACTb,EAAQyB,oBAAoB,UAAWd,EAASE,SAsChE,SAAgCb,EAASpB,GACrC,MAAMsC,EAAW5B,EAAY6B,IAAInB,GAC5BkB,IAGLA,EAASQ,OAAO9C,GAChBU,EAAYoC,OAAO1B,IAzCf2B,CAAuB3B,EAASpB,IACQ,IAApC0B,EAAuBN,IAEvBA,EAAQyB,oBAAoB,UAAWlB,KA8CnD,SAASJ,EAAoBH,EAASpB,GAClC,MAAMsC,EAAW5B,EAAY6B,IAAInB,GACjC,GAAKkB,EAIL,OADYA,EAASC,IAAIvC,GAU7B,SAAS0B,EAAuBN,GAC5B,OAAOV,EAAYsC,IAAI5B,GA0B3B,SAASO,EAAuBX,GAE5B,MAAMI,EAAUrE,KAEVkG,EAAW7B,aAAmBK,kBAC9ByB,EAAU9B,aAAmB+B,kBAAoB/B,aAAmBgC,oBACpEC,EAAaxB,EAAYb,GAC1BiC,GAAaC,IAAWG,GACzBrC,EAAEsC,iBAuBV,SAASzB,EAAYb,GAGjB,SADsBA,EAAEkB,KAAkB,MAAVlB,EAAEkB,KAAuC,aAAxBlB,EAAEkB,IAAIC,gBC9NtC,SAAWoB,EAAWhG,EAAUiG,EAAU/G,GAG9D,MAAMgH,EACI,mBADJA,EAEE,0BAFFA,EAII,gCAJJA,EAKO,gCAePC,EAAU,SAAUC,GACzB,IAAIC,EAAQ5E,OAAO6E,iBAAiBF,GAEhCG,EAAaF,EAAME,WACnBC,EAAUH,EAAMG,QAIpB,MAF+B,WAAfD,GAAuC,SAAZC,GAKtCjG,EAAS,CACdkG,KAAM,SAAUL,QACI,IAARA,IACVA,EAAMF,GAGY,iBAARE,IACVA,EAAMtF,SAAS0C,iBAAiB4C,IAG7BA,EAAI9G,OACP8G,EAAI3G,QAAQc,EAAOmG,SAEnBnG,EAAOmG,QAAQN,IAIjBM,QAAS,SAAUN,GAClB,IAAIO,EAAWP,EAAIQ,QAAQV,GAE3B3F,EAAOsG,YAAYF,IAGpBE,YAAa,SAAUF,GACtBA,EAAS1C,iBAAiB,WAAY1D,EAAOuG,WAAWH,IACxDA,EAAS1C,iBAAiB,UAAW1D,EAAOwG,SAASJ,IACrDA,EAAS1C,iBAAiB,UAAW1D,EAAOyG,kBAAkBL,IAE9D,IAAIM,EAASN,EAAS5F,cAAcmF,GAEpCe,EAAOhD,iBAAiB,QAAS1D,EAAO2G,aACxCD,EAAOhD,iBAAiB,UAAW1D,EAAO4G,sBAC1CF,EAAOhD,iBAAiB,UAAW1D,EAAO6G,qBAI3CF,YAAalH,GAAS,SAAUyD,GAC/B,IACIkD,EADSnH,KACSoH,QAAQV,GAEhB3F,EAAO8G,SAASV,KAtDlB,KAyDbU,SAAU,SAAUV,GACnB,IAAIM,EAASN,EAAS5F,cAAcmF,GAEhCoB,EAAMX,EAASrE,aAAa,4BAC5BiF,EAAMN,EAAOO,MAEjB,GAAID,EAAIjI,QA9Da,EA8Da,CACjC,IAAImI,EAAU,IAAIC,eACdC,EAAO,CACVC,MAAOL,GAGRE,EAAQI,OAAS,WAChB,IACC,GAAoB,MAAhBrI,KAAKsI,OAAgB,CACxB,IAAIC,EAAWvI,KAAKuI,SAChBJ,EAAOK,KAAKC,MAAMF,GAEtBxH,EAAO2H,cAAcvB,EAAUgB,QAE/BpH,EAAO4H,YAAYxB,GAEnB,MAAOlD,GACRlD,EAAO4H,YAAYxB,KAIrBc,EAAQW,KAAK,MAAOd,GACpBG,EAAQY,iBAAiB,eAAgB,kCACzCZ,EAAQa,KAAKN,KAAKO,UAAUZ,SAE5BpH,EAAOiI,cAAc7B,IAIvB8B,cAAe,SAAU9B,EAAUgB,GAClCpH,EAAOmI,YAAY/B,EAAUgB,GAC7BpH,EAAOoI,aAAahC,IAGrBuB,cAAe,SAAUvB,EAAUgB,GAClCpH,EAAOkI,cAAc9B,EAAUgB,IAGhCQ,YAAa,SAAUxB,GACtB,IAAI9F,EAAU8F,EAAS5F,cA/GhB,4BAiHH7B,GACHA,EAAQ,gBAAiB,8BAA+B2B,IAI1D6H,YAAa,SAAU/B,EAAUgB,GAChC,IAAIiB,EAAWjC,EAAS5F,cAAcmF,GAGlC2C,EAFYtI,EAAOuI,aAAanC,GAEXoC,UACrBC,EAAczI,EAAO0I,kBAAkBJ,EAAUlB,GAErDiB,EAASG,UAAYC,EAErBzI,EAAO2I,kBAAkBN,IAG1BK,kBAAmB,SAAUJ,EAAUlB,GAMtC,OAJAkB,EAAWA,EAASM,QAAQ,MAAO,IAEjBnD,EAAU6C,EAAV7C,CAAoB2B,IAKvCuB,kBAAmB,SAAUN,GAC5B,IAAIQ,EAAeR,EAASpF,iBAAiB0C,GAC7CkD,EAAa3J,SAAQ4J,GAAMA,EAAGpF,iBAAiB,UAAW1D,EAAO6G,sBACjEnB,EAASmD,EAAc7I,EAAO+I,qBAG/Bd,cAAe,SAAU7B,GACTA,EAAS5F,cAAcmF,GAC7B6C,UAAY,GAGrBxI,EAAOgJ,aAAa5C,IAGrBgC,aAAc,SAAUhC,GACvB,IAAIM,EAASN,EAAS5F,cAAcmF,GAChC0C,EAAWjC,EAAS5F,cAAcmF,GAClC8C,EAAcJ,EAASG,UAE3B,GAA2B,KAAvBC,EAAYQ,OAAhB,CAQA,GAJAZ,EAASG,UAAY,GACrBH,EAASvC,MAAMG,QAAU,QACzBS,EAAO5E,aAAa,iBAAiB,GAEjCnD,EAAS,CACZ,IAAIuK,EAAab,EAASpF,iBAAiB0C,GAAsB5G,OACjEJ,EAAQ,gBAAiBuK,EAAa,YAIvChI,OAAOC,YAAW,KACjBkH,EAASG,UAAYC,EACrBzI,EAAO2I,kBAAkBN,KACvB,OAGJW,aAAc,SAAU5C,GACvB,IAAIiC,EAAWjC,EAAS5F,cAAcmF,GAClCe,EAASN,EAAS5F,cAAcmF,GAEpC0C,EAASvC,MAAMG,QAAU,OACzBS,EAAO5E,aAAa,iBAAiB,GAErC9B,EAAOmJ,mBAAmB/C,IAG3BK,kBAAmB,SAAUL,GAC5B,OAAO,SAAUlD,GACY,WAAxBA,EAAEkB,IAAIC,eACTrE,EAAOgJ,aAAa5C,KAKvBG,WAAY,SAAUH,GACrB,OAAO,SAAUlD,GACAA,EAAEkG,OAGlBlI,OAAOC,YAAW,WACjB,IACIkI,EADY9I,SAAS+I,cACDjD,QAAQV,KAAuBS,EAEnDmD,EAAiBvJ,EAAOwJ,YAAYpD,IAExB,IAAZiD,IACCE,EAAelD,QAAQV,GAC1B3F,EAAOyJ,cAAcF,GAAgB,GAErCvJ,EAAOgJ,aAAa5C,MAGpB,KAILI,SAAU,SAAUJ,GACnB,OAAO,SAAUlD,GAChB,IAAIwG,EAAS1J,EAAOwJ,YAAYpD,GAC5BiC,EAAWjC,EAAS5F,cAAcmF,GAElC0D,EAAUK,EAAOrD,QAAQV,KAAuBS,EAChDuD,EAAiB/D,EAAQyC,GACzBuB,EAA2C,KAA9BvB,EAASG,UAAUS,OAEhCI,IAAYM,GAAkBC,GACjC5J,EAAOoI,aAAahC,KAKvBmC,aAAc,SAAUnC,GACvB,IAAIyD,EAAYzD,EAAS5F,cA3OhB,8BA6OT,GAAyB,IAArBqJ,EAAU9K,OAAc,CAC3B,IAAI+K,EAAa1D,EAASrE,aAAa,iCACvC8H,EAAYtJ,SAASwJ,eAAeD,GAGrC,OAAOD,GAGRd,mBAAoB,SAAU7F,GAC7B,IAAIkD,EAAWlD,EAAEkG,OAAO/C,QAAQV,GAC5BqE,EAAU9G,EAAEkG,OAAO/C,QAAQV,GAE/B,IAAKqE,EAAS,CACb,IAAInB,EAAezC,EAASnD,iBAAiB0C,GAC7CqE,EAAUC,MAAMC,UAAUC,KAAKnL,KAAK6J,GAAcC,GAA2C,SAArCA,EAAG/G,aAAa,mBAGnEiI,IAAsD,IAA1CA,EAAQI,QAAQzE,KACjCqE,EAAUhK,EAAOwJ,YAAYpD,IAG1B4D,GAAWA,EAAQI,QAAQzE,KAC9BzC,EAAEsC,iBACFxF,EAAOyJ,cAAcO,GAAS,KAIhCpD,qBAAsB,SAAU1D,GACH,UAAxBA,EAAEkB,IAAIC,eACTrE,EAAO+I,mBAAmB7F,IAI5BuG,cAAe,SAAUO,EAASK,GACjC,IAAIjE,EAAW4D,EAAQ3D,QAAQV,GAE3Be,GADWN,EAAS5F,cAAcmF,GACzBS,EAAS5F,cAAcmF,IAEpCe,EAAOO,MAAQ+C,EAAQjI,aAAa,2BAEhCsI,GACH3D,EAAO4D,QAGRtK,EAAOiI,cAAc7B,IAGtBS,mBAAoB,SAAU3D,GAC7B,IASIqH,EATAnG,EAAMlB,EAAEkB,IAAIC,cAEZ+B,EAAWlD,EAAEkG,OAAO/C,QAAQV,GAC5B0C,EAAWjC,EAAS5F,cAAcmF,GAClCkD,EAAezC,EAASnD,iBAAiB0C,GAC7C,IAAKkD,EAAa9J,OACjB,OAID,GAAY,YAARqF,GAA6B,OAARA,EAAc,CACtC,GAAIlB,EAAEsH,SAAwC,IAA7B5E,EAAQiD,EAAa,IAErC,YADA7I,EAAOgJ,aAAa5C,GAGrBmE,GAAU,MACJ,IAAY,cAARnG,GAA+B,SAARA,EAWjC,YAJY,cAARA,GAA+B,SAARA,GAA0B,eAARA,GAAgC,UAARA,GAA2B,SAARA,GAA0B,QAARA,GAEzGpE,EAAOmJ,mBAAmB/C,IAR3B,GAAIlD,EAAEsH,SAAiC,IAAtB5E,EAAQyC,GAExB,YADArI,EAAOoI,aAAahC,GAGrBmE,EAAS,EAUVrH,EAAEsC,iBAEF,IAAIwE,EAAUhK,EAAOwJ,YAAYpD,GAAUC,QAAQV,GAG/C8E,EADQR,MAAMC,UAAUQ,QAAQ1L,KAAK6J,EAAcmB,GAChCO,GAAU,EAE7BE,EAAW,EACdA,EAAW5B,EAAa9J,OAAS,EACvB0L,GAAY5B,EAAa9J,SACnC0L,GAAsB5B,EAAa9J,QAGpCiL,EAAUnB,EAAa4B,GAEvBzK,EAAO2K,gBAAgBX,IAGxBW,gBAAiB,SAAUX,GAC1B,IAAI5D,EAAW4D,EAAQ3D,QAAQV,GAC3Be,EAASN,EAAS5F,cAAcmF,GACrBS,EAASnD,iBAAiB0C,GAEhCzG,SAAQ4J,IACZA,IAAOkB,GACVlB,EAAGhH,aAAa,iBAAiB,MAGnC4E,EAAO5E,aAAa,wBAAyBkI,EAAQjI,aAAa,OAClEiI,EAAQlI,aAAa,iBAAiB,IAGvCqH,mBAAoB,SAAU/C,GAC7B,IAAIM,EAASN,EAAS5F,cAAcmF,GAChCkD,EAAezC,EAASnD,iBAAiB0C,GAE7Ce,EAAOzE,gBAAgB,yBACvB4G,EAAa3J,SAAQ4J,GAAMA,EAAGhH,aAAa,iBAAiB,MAG7D0H,YAAa,SAAUpD,GACtB,IAAIwE,EAEAC,EADSzE,EAAS5F,cAAcmF,GACL5D,aAAa,yBAU5C,OARI8I,IACHD,EAAWrK,SAASwJ,eAAec,IAG/BA,GAAyC,IAApBD,EAAS7L,SAClC6L,EAAWrK,SAAS+I,eAGdsB,IAIT,MAAO,CACN1E,KAAMlG,EAAOkG,OAhYM,CAkYlBT,UAAWhG,GDzJd,SAAkBsD,EAAUb,GACxBY,EAAWC,EAAUb,EAAIqB,KCwJK5E,GCvYlC,Q","file":"autocomplete.bundle.js","sourcesContent":["const subscriptions = {};\r\n// Split by whitespace, then remove any empty strings\r\nconst split = (eventString) => eventString.split(/\\s+/).filter(str => !!str);\r\nconst publish = function (event, ...args) {\r\n    const events = split(event);\r\n    if (events.length > 1) {\r\n        for (const event of events) {\r\n            publish.call(this, event, ...args);\r\n        }\r\n    }\r\n    else if (event in subscriptions) {\r\n        const callbacks = subscriptions[event];\r\n        callbacks.forEach((callback) => {\r\n            callback.apply(null, args);\r\n        });\r\n    }\r\n};\r\nconst subscribe = function (event, callback) {\r\n    const events = split(event);\r\n    if (events.length > 1) {\r\n        for (const event of events) {\r\n            subscribe(event, callback);\r\n        }\r\n    }\r\n    else {\r\n        if (!(event in subscriptions)) {\r\n            subscriptions[event] = [];\r\n        }\r\n        const callbacks = subscriptions[event];\r\n        // Don't bind a particular function to an event more than once\r\n        if (callbacks.includes(callback) === false) {\r\n            callbacks.push(callback);\r\n        }\r\n    }\r\n};\r\nconst unsubscribe = function (event, callback) {\r\n    if (event in subscriptions) {\r\n        const callbacks = subscriptions[event];\r\n        const index = callbacks.indexOf(callback);\r\n        if (index !== -1) {\r\n            callbacks.splice(index, 1);\r\n        }\r\n    }\r\n};\r\nexport { publish, subscribe, unsubscribe };\r\n//# sourceMappingURL=pubsub.js.map","/**\r\n * Create a version of fn that will execute only after\r\n * no attempt to call it has been made for delay ms.\r\n * The debounced function returns a Promise that\r\n * resolves to the value returned by fn.\r\n *\r\n * Note that this will uncouple the callback from user\r\n * input, if used as an event callback. This can cause\r\n * browsers to attempt to block certain behaviour.\r\n *\r\n * This throttling is useful, for example, for waiting until\r\n * the user has stopped typing before executing a keyup callback.\r\n *\r\n * @param {Function} fn - A function to debounce\r\n * @param {number} delay - The duration to wait before calling the function (ms)\r\n */\r\nconst debounce = function (fn, delay) {\r\n    // Keep track of the timeout, Promise, and the Promise's resolver across multiple calls\r\n    // This lets later calls in the same queue know about the previous call,\r\n    // to cancel its timeout and use the same promise and resolution\r\n    // Use ReturnType<typeof setTimeout> for support across ES and NodeJS environments\r\n    let timeout;\r\n    let promise;\r\n    let res;\r\n    return function (...args) {\r\n        const scheduleResolution = (resolve) => {\r\n            if (timeout) {\r\n                clearTimeout(timeout);\r\n            }\r\n            timeout = setTimeout(() => {\r\n                timeout = undefined;\r\n                promise = undefined;\r\n                res = undefined;\r\n                resolve(fn.apply(this, args));\r\n            }, delay);\r\n        };\r\n        if (res) {\r\n            scheduleResolution(res);\r\n        }\r\n        else {\r\n            promise = new Promise((resolve, reject) => {\r\n                res = resolve;\r\n                scheduleResolution(res);\r\n            });\r\n        }\r\n        // There is no type guard for promise on the `if (res)` path,\r\n        // but if res is not undefined, then neither is promise\r\n        return promise;\r\n    };\r\n};\r\nexport { debounce };\r\nexport default debounce;\r\n//# sourceMappingURL=debounce.js.map","/* Status 1.1 */\n\nimport { subscribe } from '@cipscis/pubsub'\n\nconst status = (function (subscribe) {\n\tconst selectors = {\n\t\tstatus: '.js-status'\n\t};\n\n\tconst dataAttributes = {\n\t\tautohide: 'data-autohide-timeout'\n\t};\n\n\tconst events = {\n\t\tsuccess: '/status/success',\n\t\terror: '/status/error',\n\t\thide: '/status/hide'\n\t};\n\n\tconst Types = {\n\t\tSUCCESS: 'SUCCESS',\n\t\tERROR: 'ERROR'\n\t};\n\n\tconst classes = {\n\t\t[Types.SUCCESS]: 'success',\n\t\t[Types.ERROR]: 'error',\n\n\t\thidden: 'hidden'\n\t};\n\n\t// Delay is used for screen reader accessibility.\n\t// Make sure it matches the delay on CSS animations or transitions\n\tconst delay = 100; // ms\n\n\tconst module = {\n\t\t_initSubscriptions: function () {\n\t\t\tif (subscribe) {\n\t\t\t\tsubscribe(events.success, module.success);\n\t\t\t\tsubscribe(events.error, module.error);\n\t\t\t\tsubscribe(events.hide, module.hide);\n\t\t\t}\n\t\t},\n\n\t\t_getEl: function ($status) {\n\t\t\tif (typeof $status === 'string') {\n\t\t\t\t$status = document.querySelector($status);\n\t\t\t} else if ($status instanceof NodeList) {\n\t\t\t\t$status = $status[0];\n\t\t\t} else if (typeof $status === 'undefined') {\n\t\t\t\t$status = document.querySelector(selectors.status);\n\t\t\t}\n\n\t\t\tif (!$status) {\n\t\t\t\tconsole.error('No status element could be found');\n\t\t\t}\n\n\t\t\treturn $status;\n\t\t},\n\n\t\t_clearType: function ($status) {\n\t\t\tfor (let type in Types) {\n\t\t\t\tlet cssClass = classes[type];\n\n\t\t\t\tif ($status.classList.contains(cssClass)) {\n\t\t\t\t\t$status.classList.remove(cssClass);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_setType: function (type, $status) {\n\t\t\tlet cssClass = classes[type];\n\n\t\t\tif (!cssClass) {\n\t\t\t\tconsole.error('No CSS class is defined for status type ' + type);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tmodule._clearType($status);\n\n\t\t\t// Asynchronous so the class gets added back even if it was\n\t\t\t// just removed, ensuring any CSS animation is triggered\n\t\t\twindow.setTimeout(() => $status.classList.add(cssClass), 10);\n\t\t},\n\n\t\t_clearMessage: function ($status) {\n\t\t\t$status.textContent = '';\n\t\t},\n\n\t\t_setMessage: function (message, $status) {\n\t\t\tmodule._clearMessage($status);\n\n\t\t\t// Asynchronous so it can fire after\n\t\t\t// the element becomes visible, and\n\t\t\t// therefore be detected as a change\n\t\t\t// by screen readers.\n\t\t\twindow.setTimeout(() => $status.textContent = message, delay);\n\t\t},\n\n\t\t_show: function (message, type, $status, autohideDelay) {\n\t\t\tmodule._setType(type, $status);\n\t\t\tmodule._setMessage(message, $status);\n\n\t\t\t$status.classList.remove(classes.hidden);\n\n\t\t\tmodule._setAutohide($status, autohideDelay);\n\t\t},\n\n\t\t_setAutohide: function ($status, autohideDelay) {\n\t\t\tmodule._clearAutohide($status);\n\n\t\t\tif (autohideDelay && autohideDelay > 0) {\n\t\t\t\tlet autohideTimeout = window.setTimeout(() => module.hide($status), autohideDelay);\n\t\t\t\t$status.setAttribute(dataAttributes.autohide, autohideTimeout);\n\t\t\t}\n\t\t},\n\n\t\t_clearAutohide: function ($status) {\n\t\t\tlet autohideTimeout = $status.getAttribute(dataAttributes.autohide);\n\n\t\t\tif (autohideTimeout) {\n\t\t\t\twindow.clearTimeout(autohideTimeout);\n\t\t\t\t$status.removeAttribute(dataAttributes.autohide);\n\t\t\t}\n\t\t},\n\n\t\thide: function ($status) {\n\t\t\t$status = module._getEl($status);\n\n\t\t\t$status.classList.add(classes.hidden);\n\t\t\tmodule._clearAutohide($status);\n\t\t},\n\n\t\tsuccess: function (message, $status, autohideDelay) {\n\t\t\t$status = module._getEl($status);\n\n\t\t\tmodule._show(message, Types.SUCCESS, $status, autohideDelay);\n\t\t},\n\n\t\terror: function (message, $status, autohideDelay) {\n\t\t\t$status = module._getEl($status);\n\n\t\t\tmodule._show(message, Types.ERROR, $status, autohideDelay);\n\t\t}\n\t};\n\n\tmodule._initSubscriptions();\n\n\treturn {\n\t\thide: module.hide,\n\t\tsuccess: module.success,\n\t\terror: module.error\n\t};\n})(subscribe);\n\nexport { status };\nexport default status;\n","const boundEvents = new Map();\r\n/**\r\n * Handles the conversion of the elements parameter so the activator function only ever has to deal with single HTMLElements.\r\n *\r\n * @param {string | HTMLElement | NodeListOf<HTMLElement>} elements - A CSS selector string, HTMLElement, or NodeList of HTMLElements to be converted so the activator function is called once for each resulting HTMLElement.\r\n * @param {ActivateEventListener} fn - The event listener to bind to each HTMLElement.\r\n * @param {(element: HTMLElement, fn: ActivateEventListener) => void} activator - The function to link each HTMLElement to fn.\r\n *\r\n * @throws {DOMException} - If the elements argument is an invalid CSS selector string.\r\n */\r\nfunction _activator(elements, fn, activator) {\r\n    // Share the same initial logic between activate and deactivate,\r\n    // but run a different function over each element\r\n    if (typeof elements === 'string') {\r\n        try {\r\n            elements = document.querySelectorAll(elements);\r\n        }\r\n        catch (e) {\r\n            const method = activator === _deactivateSingle ? 'deactivate' : 'activate';\r\n            throw new DOMException(`${method} failed because it was passed an invalid selector string: '${elements}'`);\r\n        }\r\n    }\r\n    if (elements instanceof HTMLElement) {\r\n        activator(elements, fn);\r\n    }\r\n    else {\r\n        elements.forEach((element) => activator(element, fn));\r\n    }\r\n}\r\n/**\r\n * Binds fn to a single element.\r\n *\r\n * @param {HTMLElement} element\r\n * @param {ActivateEventListener} fn\r\n *\r\n * @throws {TypeError} - element must be an HTMLElement.\r\n */\r\nfunction _activateSingle(element, fn) {\r\n    if (!(element instanceof HTMLElement)) {\r\n        throw new TypeError(`activate failed because a valid HTMLElement was not passed`);\r\n    }\r\n    if (_getElementBindings(element, fn)) {\r\n        // Like addEventListener, don't try to rebind new copies of the same events\r\n        return;\r\n    }\r\n    // All nodes should bind the click event\r\n    element.addEventListener('click', fn);\r\n    // Buttons will already treat keyboard events like clicks,\r\n    // so only bind them to other element types\r\n    if (!(element instanceof HTMLButtonElement)) {\r\n        if (_getElementHasBindings(element) === false) {\r\n            // addEventListener would prevent this event being\r\n            // bound multiple times, but be explicit that it is\r\n            // only bound if the element has no other events bound\r\n            element.addEventListener('keydown', _preventSpacebarScroll);\r\n        }\r\n        const spacebarFn = _makeSpacebarFn(fn);\r\n        element.addEventListener('keyup', spacebarFn);\r\n        const bindings = {\r\n            spacebarFn\r\n        };\r\n        // Links already treat \"enter\" keydown like a click\r\n        if (!(element instanceof HTMLAnchorElement)) {\r\n            // Note that holding down \"enter\" will behave differently\r\n            // for links in that it will only fire once, whereas for\r\n            // non-links, including buttons, it will fire multiple times\r\n            const enterFn = _makeEnterFn(fn);\r\n            element.addEventListener('keydown', enterFn);\r\n            bindings.enterFn = enterFn;\r\n        }\r\n        _rememberElementBindings(element, fn, bindings);\r\n    }\r\n}\r\n/**\r\n * Unbinds fn from a single element.\r\n *\r\n * @param {HTMLElement} element\r\n * @param {ActivateEventListener} fn\r\n *\r\n * @throws {TypeError} - element must be an HTMLElement.\r\n */\r\nfunction _deactivateSingle(element, fn) {\r\n    if (!(element instanceof HTMLElement)) {\r\n        throw new TypeError(`deactivate failed because a valid HTMLElement was not passed`);\r\n    }\r\n    // All elements have had a click event bound\r\n    element.removeEventListener('click', fn);\r\n    const bindings = _getElementBindings(element, fn);\r\n    if (!bindings) {\r\n        // No other events to unbind\r\n        return;\r\n    }\r\n    // Buttons will already treat keyboard events like clicks,\r\n    // so they didn't have keyboard events bound to them\r\n    if (!(element instanceof HTMLButtonElement)) {\r\n        if (bindings.spacebarFn) {\r\n            element.removeEventListener('keyup', bindings.spacebarFn);\r\n        }\r\n        // Links already treat \"enter\" keydown like a click,\r\n        // so that event wasn't bound to them\r\n        if (!(element instanceof HTMLAnchorElement)) {\r\n            if (bindings.enterFn) {\r\n                element.removeEventListener('keydown', bindings.enterFn);\r\n            }\r\n        }\r\n        _forgetElementBindings(element, fn);\r\n        if (_getElementHasBindings(element) === false) {\r\n            // Only unbind this event if the element has no other bindings\r\n            element.removeEventListener('keydown', _preventSpacebarScroll);\r\n        }\r\n    }\r\n}\r\n/**\r\n * Record a new set of bindings for a particular element, associated with a new primary binding.\r\n *\r\n * @param {HTMLElement} element\r\n * @param {ActivateEventListener} fn - The primary binding.\r\n * @param {ActivateBinding} bindings - The secondary bindings.\r\n */\r\nfunction _rememberElementBindings(element, fn, bindings) {\r\n    let elementB = boundEvents.get(element);\r\n    if (!elementB) {\r\n        elementB = new Map([[fn, bindings]]);\r\n        boundEvents.set(element, elementB);\r\n    }\r\n    let fnB = elementB.get(fn);\r\n    if (fnB) {\r\n        Object.assign(fnB, bindings);\r\n    }\r\n    else {\r\n        fnB = Object.assign({}, bindings);\r\n        elementB.set(fn, fnB);\r\n    }\r\n}\r\n/**\r\n * Delete any records of bindings for a particular element and primary binding pair.\r\n *\r\n * @param {HTMLElement} element\r\n * @param {ActivateEventListener} fn\r\n */\r\nfunction _forgetElementBindings(element, fn) {\r\n    const elementB = boundEvents.get(element);\r\n    if (!elementB) {\r\n        return;\r\n    }\r\n    elementB.delete(fn);\r\n    boundEvents.delete(element);\r\n}\r\n/**\r\n * Return the bindings for a particular element and primary binding pair.\r\n *\r\n * @param {HTMLElement} element\r\n * @param {ActivateEventListener} fn\r\n */\r\nfunction _getElementBindings(element, fn) {\r\n    const elementB = boundEvents.get(element);\r\n    if (!elementB) {\r\n        return undefined;\r\n    }\r\n    const fnB = elementB.get(fn);\r\n    return fnB;\r\n}\r\n/**\r\n * Checks whether or not any bindings are recorded for a particular element and primary binding pair.\r\n *\r\n * @param  {HTMLElement} element\r\n *\r\n * @return {boolean}\r\n */\r\nfunction _getElementHasBindings(element) {\r\n    return boundEvents.has(element);\r\n}\r\nfunction _makeEnterFn(fn) {\r\n    return function (e) {\r\n        const isEnter = _isEnter(e);\r\n        if (isEnter) {\r\n            return fn.call(this, e);\r\n        }\r\n    };\r\n}\r\n/**\r\n * For a given KeyboardEvent, checks if it was triggered by the 'enter' key.\r\n *\r\n * @param  {KeyboardEvent} e\r\n *\r\n * @return {boolean}\r\n */\r\nfunction _isEnter(e) {\r\n    const isEnter = !!(e.key && (e.key.toLowerCase() === 'enter'));\r\n    return isEnter;\r\n}\r\n/**\r\n * For a given KeyboardEvent, if it was triggered by the 'spacebar' key, prevent the default action of scrolling the page.\r\n *\r\n * @param {KeyboardEvent} e\r\n */\r\nfunction _preventSpacebarScroll(e) {\r\n    // Prevent spacebar from scrolling the page down on keydown\r\n    const element = this;\r\n    // Buttons and inputs don't have this default action of the 'spacebar' key, so don't prevent it.\r\n    const isButton = element instanceof HTMLButtonElement;\r\n    const isInput = element instanceof HTMLInputElement || element instanceof HTMLTextAreaElement;\r\n    const isSpacebar = _isSpacebar(e);\r\n    if (!isButton && !isInput && isSpacebar) {\r\n        e.preventDefault();\r\n    }\r\n}\r\n/**\r\n * Create a secondary binding that calls fn when triggered via the spacebar.\r\n *\r\n * @param {ActivateEventListener} fn\r\n */\r\nfunction _makeSpacebarFn(fn) {\r\n    return function (e) {\r\n        const isSpacebar = _isSpacebar(e);\r\n        if (isSpacebar) {\r\n            return fn.call(this, e);\r\n        }\r\n    };\r\n}\r\n/**\r\n * Checks if a given KeyboardEvent was triggered by the 'spacebar' key.\r\n *\r\n * @param  {KeyboardEvent} e\r\n *\r\n * @return {boolean}\r\n */\r\nfunction _isSpacebar(e) {\r\n    // IE11 uses 'spacebar' instead of ' '\r\n    const isSpacebar = !!(e.key && (e.key === ' ' || e.key.toLowerCase() === 'spacebar'));\r\n    return isSpacebar;\r\n}\r\n/**\r\n * Bind fn to all specified elements.\r\n *\r\n * @param {string | HTMLElement | NodeListOf<HTMLElement>} elements - The elements to have fn bound to them.\r\n * @param {ActivateEventListener} fn - The event listener to bind.\r\n *\r\n * @throws {DOMException} - If the elements argument is an invalid CSS selector string.\r\n */\r\nfunction activate(elements, fn) {\r\n    _activator(elements, fn, _activateSingle);\r\n}\r\n/**\r\n * Unbind fn from all specified elements.\r\n *\r\n * @param {string | HTMLElement | NodeListOf<HTMLElement>} elements - The elements to have fn unbound from them.\r\n * @param {ActivateEventListener} fn - The event listener to unbind.\r\n *\r\n * @throws {DOMException} - If the elements argument is an invalid CSS selector string.\r\n */\r\nfunction deactivate(elements, fn) {\r\n    _activator(elements, fn, _deactivateSingle);\r\n}\r\nexport { activate, deactivate, };\r\nexport default activate;\r\n//# sourceMappingURL=activate.js.map","/* Autocomplete 1.0 */\n\nimport { status } from '../status/status.js';\nimport { debounce } from '@cipscis/debounce';\nimport { activate } from '@cipscis/activate';\nimport { publish } from '@cipscis/pubsub';\n\nconst autocomplete = (function (templayed, debounce, activate, publish) {\n\t'use strict';\n\n\tconst selectors = {\n\t\twrapper: '.js-autocomplete',\n\t\tinput: '.js-autocomplete__input',\n\n\t\tresults: '.js-autocomplete__result-list',\n\t\tresultItem: '.js-autocomplete__result-item',\n\n\t\ttemplate: '.js-autocomplete__template',\n\t\tstatus: '.js-autocomplete__status'\n\t};\n\n\tconst dataSelectors = {\n\t\tsource: 'autocomplete-source',\n\t\tvalue: 'autocomplete-value',\n\t\ttemplateId: 'autocomplete-template-id'\n\t};\n\n\tconst delay = 500;\n\tconst minQueryLength = 3;\n\n\tconst visible = function ($el) {\n\t\tlet style = window.getComputedStyle($el);\n\n\t\tlet visibility = style.visibility;\n\t\tlet display = style.display;\n\n\t\tlet isVisible = visibility !== 'hidden' && display !== 'none';\n\n\t\treturn isVisible;\n\t};\n\n\tconst module = {\n\t\tinit: function ($el) {\n\t\t\tif (typeof $el === 'undefined') {\n\t\t\t\t$el = selectors.wrapper;\n\t\t\t}\n\n\t\t\tif (typeof $el === 'string') {\n\t\t\t\t$el = document.querySelectorAll($el);\n\t\t\t}\n\n\t\t\tif ($el.length) {\n\t\t\t\t$el.forEach(module._initEl);\n\t\t\t} else {\n\t\t\t\tmodule._initEl($el);\n\t\t\t}\n\t\t},\n\n\t\t_initEl: function ($el) {\n\t\t\tlet $wrapper = $el.closest(selectors.wrapper);\n\n\t\t\tmodule._initEvents($wrapper);\n\t\t},\n\n\t\t_initEvents: function ($wrapper) {\n\t\t\t$wrapper.addEventListener('focusout', module._onUnfocus($wrapper));\n\t\t\t$wrapper.addEventListener('focusin', module._onFocus($wrapper));\n\t\t\t$wrapper.addEventListener('keydown', module._hideResultsOnEsc($wrapper));\n\n\t\t\tlet $input = $wrapper.querySelector(selectors.input);\n\n\t\t\t$input.addEventListener('input', module._inputEvent);\n\t\t\t$input.addEventListener('keydown', module._selectResultOnEnter);\n\t\t\t$input.addEventListener('keydown', module._changeResultFocus);\n\t\t},\n\n\t\t// Just run debounce once, instead of creating a new debounced function each time\n\t\t_inputEvent: debounce(function (e) {\n\t\t\tlet $input = this;\n\t\t\tlet $wrapper = $input.closest(selectors.wrapper);\n\n\t\t\tlet results = module._doQuery($wrapper);\n\t\t}, delay),\n\n\t\t_doQuery: function ($wrapper) {\n\t\t\tlet $input = $wrapper.querySelector(selectors.input);\n\n\t\t\tlet url = $wrapper.getAttribute(`data-${dataSelectors.source}`);\n\t\t\tlet val = $input.value;\n\n\t\t\tif (val.length >= minQueryLength) {\n\t\t\t\tlet request = new XMLHttpRequest();\n\t\t\t\tlet data = {\n\t\t\t\t\tquery: val\n\t\t\t\t};\n\n\t\t\t\trequest.onload = function () {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (this.status === 200) {\n\t\t\t\t\t\t\tlet response = this.response;\n\t\t\t\t\t\t\tlet data = JSON.parse(response);\n\n\t\t\t\t\t\t\tmodule._querySuccess($wrapper, data);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmodule._queryError($wrapper);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tmodule._queryError($wrapper);\n\t\t\t\t\t\t// console.error(e);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\trequest.open('GET', url);\n\t\t\t\trequest.setRequestHeader('Content-Type', 'application/json;charset=UTF-8');\n\t\t\t\trequest.send(JSON.stringify(data));\n\t\t\t} else {\n\t\t\t\tmodule._clearResults($wrapper);\n\t\t\t}\n\t\t},\n\n\t\t_buildResults: function ($wrapper, data) {\n\t\t\tmodule._setResults($wrapper, data);\n\t\t\tmodule._showResults($wrapper);\n\t\t},\n\n\t\t_querySuccess: function ($wrapper, data) {\n\t\t\tmodule._buildResults($wrapper, data);\n\t\t},\n\n\t\t_queryError: function ($wrapper) {\n\t\t\tlet $status = $wrapper.querySelector(selectors.status);\n\n\t\t\tif (publish) {\n\t\t\t\tpublish('/status/error', 'Sorry, something went wrong', $status);\n\t\t\t}\n\t\t},\n\n\t\t_setResults: function ($wrapper, data) {\n\t\t\tlet $results = $wrapper.querySelector(selectors.results);\n\t\t\tlet $template = module._getTemplate($wrapper);\n\n\t\t\tlet template = $template.innerHTML;\n\t\t\tlet resultsHtml = module._buildResultsHtml(template, data);\n\n\t\t\t$results.innerHTML = resultsHtml;\n\n\t\t\tmodule._bindResultEvents($results);\n\t\t},\n\n\t\t_buildResultsHtml: function (template, data) {\n\t\t\t// Templayed has trouble with carriage returns\n\t\t\ttemplate = template.replace(/\\r/g, '');\n\n\t\t\tlet resultsHtml = templayed(template)(data);\n\n\t\t\treturn resultsHtml;\n\t\t},\n\n\t\t_bindResultEvents: function ($results) {\n\t\t\tlet $resultItems = $results.querySelectorAll(selectors.resultItem);\n\t\t\t$resultItems.forEach(el => el.addEventListener('keydown', module._changeResultFocus));\n\t\t\tactivate($resultItems, module._selectResultEvent);\n\t\t},\n\n\t\t_clearResults: function ($wrapper) {\n\t\t\tlet $results = $wrapper.querySelector(selectors.results);\n\t\t\t$results.innerHTML = '';\n\n\n\t\t\tmodule._hideResults($wrapper);\n\t\t},\n\n\t\t_showResults: function ($wrapper) {\n\t\t\tlet $input = $wrapper.querySelector(selectors.input);\n\t\t\tlet $results = $wrapper.querySelector(selectors.results);\n\t\t\tlet resultsHtml = $results.innerHTML;\n\n\t\t\tif (resultsHtml.trim() === '') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$results.innerHTML = '';\n\t\t\t$results.style.display = 'block';\n\t\t\t$input.setAttribute('aria-expanded', true);\n\n\t\t\tif (publish) {\n\t\t\t\tlet numResults = $results.querySelectorAll(selectors.resultItem).length;\n\t\t\t\tpublish('/assist/speak', numResults + ' results');\n\t\t\t}\n\n\t\t\t// Asynchronous to allow screen readers to read it out\n\t\t\twindow.setTimeout(() => {\n\t\t\t\t$results.innerHTML = resultsHtml;\n\t\t\t\tmodule._bindResultEvents($results);\n\t\t\t}, 100);\n\t\t},\n\n\t\t_hideResults: function ($wrapper) {\n\t\t\tlet $results = $wrapper.querySelector(selectors.results);\n\t\t\tlet $input = $wrapper.querySelector(selectors.input);\n\n\t\t\t$results.style.display = 'none';\n\t\t\t$input.setAttribute('aria-expanded', false);\n\n\t\t\tmodule._removeResultFocus($wrapper);\n\t\t},\n\n\t\t_hideResultsOnEsc: function ($wrapper) {\n\t\t\treturn function (e) {\n\t\t\t\tif (e.key.toLowerCase() === 'escape') {\n\t\t\t\t\tmodule._hideResults($wrapper);\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\n\t\t_onUnfocus: function ($wrapper) {\n\t\t\treturn function (e) {\n\t\t\t\tlet $hadFocus = e.target;\n\n\t\t\t\t// 1 ms timeout so we can check what element has focus after blur\n\t\t\t\twindow.setTimeout(function () {\n\t\t\t\t\tlet $hasFocus = document.activeElement;\n\t\t\t\t\tlet inFocus = $hasFocus.closest(selectors.wrapper) === $wrapper;\n\n\t\t\t\t\tlet $focusedResult = module._getFocusEl($wrapper);\n\n\t\t\t\t\tif (inFocus === false) {\n\t\t\t\t\t\tif ($focusedResult.closest(selectors.resultItem)) {\n\t\t\t\t\t\t\tmodule._selectResult($focusedResult, false);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmodule._hideResults($wrapper);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, 1);\n\t\t\t}\n\t\t},\n\n\t\t_onFocus: function ($wrapper) {\n\t\t\treturn function (e) {\n\t\t\t\tlet $focus = module._getFocusEl($wrapper);\n\t\t\t\tlet $results = $wrapper.querySelector(selectors.results);\n\n\t\t\t\tlet inFocus = $focus.closest(selectors.wrapper) === $wrapper;\n\t\t\t\tlet resultsVisible = visible($results);\n\t\t\t\tlet hasResults = $results.innerHTML.trim() !== '';\n\n\t\t\t\tif (inFocus && !resultsVisible && hasResults) {\n\t\t\t\t\tmodule._showResults($wrapper);\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\n\t\t_getTemplate: function ($wrapper) {\n\t\t\tlet $template = $wrapper.querySelector(selectors.template);\n\n\t\t\tif ($template.length === 0) {\n\t\t\t\tlet templateId = $wrapper.getAttribute(`data-${dataSelectors.templateId}`);\n\t\t\t\t$template = document.getElementById(templateId);\n\t\t\t}\n\n\t\t\treturn $template;\n\t\t},\n\n\t\t_selectResultEvent: function (e) {\n\t\t\tlet $wrapper = e.target.closest(selectors.wrapper);\n\t\t\tlet $result = e.target.closest(selectors.resultItem);\n\n\t\t\tif (!$result) {\n\t\t\t\tlet $resultItems = $wrapper.querySelectorAll(selectors.resultItem);\n\t\t\t\t$result = Array.prototype.find.call($resultItems, el => el.getAttribute('aria-selected') === 'true');\n\t\t\t}\n\n\t\t\tif ((!$result) || $result.matches(selectors.resultItem) === false) {\n\t\t\t\t$result = module._getFocusEl($wrapper);\n\t\t\t}\n\n\t\t\tif ($result && $result.matches(selectors.resultItem)) {\n\t\t\t\te.preventDefault();\n\t\t\t\tmodule._selectResult($result, true);\n\t\t\t}\n\t\t},\n\n\t\t_selectResultOnEnter: function (e) {\n\t\t\tif (e.key.toLowerCase() === 'enter') {\n\t\t\t\tmodule._selectResultEvent(e);\n\t\t\t}\n\t\t},\n\n\t\t_selectResult: function ($result, focusOnInput) {\n\t\t\tlet $wrapper = $result.closest(selectors.wrapper);\n\t\t\tlet $results = $wrapper.querySelector(selectors.results);\n\t\t\tlet $input = $wrapper.querySelector(selectors.input);\n\n\t\t\t$input.value = $result.getAttribute(`data-${dataSelectors.value}`);\n\n\t\t\tif (focusOnInput) {\n\t\t\t\t$input.focus();\n\t\t\t}\n\n\t\t\tmodule._clearResults($wrapper);\n\t\t},\n\n\t\t_changeResultFocus: function (e) {\n\t\t\tlet key = e.key.toLowerCase();\n\n\t\t\tlet $wrapper = e.target.closest(selectors.wrapper);\n\t\t\tlet $results = $wrapper.querySelector(selectors.results);\n\t\t\tlet $resultItems = $wrapper.querySelectorAll(selectors.resultItem);\n\t\t\tif (!$resultItems.length) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet offset;\n\t\t\tif (key === 'arrowup' || key === 'up') {\n\t\t\t\tif (e.altKey && (visible($resultItems[0]) === true)) {\n\t\t\t\t\tmodule._hideResults($wrapper);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\toffset = -1;\n\t\t\t} else if (key === 'arrowdown' || key === 'down') {\n\t\t\t\tif (e.altKey && (visible($results) === false)) {\n\t\t\t\t\tmodule._showResults($wrapper);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\toffset = +1;\n\t\t\t} else {\n\t\t\t\tif (key === 'arrowleft' || key === 'left' || key === 'arrowright' || key === 'right' || key === 'home' || key === 'end') {\n\t\t\t\t\t// If moving the caret within the input, return focus\n\t\t\t\t\tmodule._removeResultFocus($wrapper);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Don't scroll with arrow press\n\t\t\te.preventDefault();\n\n\t\t\tlet $result = module._getFocusEl($wrapper).closest(selectors.resultItem);\n\n\t\t\tlet index = Array.prototype.indexOf.call($resultItems, $result);\n\t\t\tlet newIndex = index + offset || 0;\n\n\t\t\tif (newIndex < 0) {\n\t\t\t\tnewIndex = $resultItems.length - 1;\n\t\t\t} else if (newIndex >= $resultItems.length) {\n\t\t\t\tnewIndex = newIndex % $resultItems.length;\n\t\t\t}\n\n\t\t\t$result = $resultItems[newIndex];\n\n\t\t\tmodule._setResultFocus($result);\n\t\t},\n\n\t\t_setResultFocus: function ($result) {\n\t\t\tlet $wrapper = $result.closest(selectors.wrapper);\n\t\t\tlet $input = $wrapper.querySelector(selectors.input);\n\t\t\tlet $results = $wrapper.querySelectorAll(selectors.resultItem);\n\n\t\t\t$results.forEach(el => {\n\t\t\t\tif (el !== $result) {\n\t\t\t\t\tel.setAttribute('aria-selected', false);\n\t\t\t\t}\n\t\t\t});\n\t\t\t$input.setAttribute('aria-activedescendant', $result.getAttribute('id'));\n\t\t\t$result.setAttribute('aria-selected', true);\n\t\t},\n\n\t\t_removeResultFocus: function ($wrapper) {\n\t\t\tlet $input = $wrapper.querySelector(selectors.input);\n\t\t\tlet $resultItems = $wrapper.querySelectorAll(selectors.resultItem);\n\n\t\t\t$input.removeAttribute('aria-activedescendant');\n\t\t\t$resultItems.forEach(el => el.setAttribute('aria-selected', false));\n\t\t},\n\n\t\t_getFocusEl: function ($wrapper) {\n\t\t\tlet $focusEl;\n\t\t\tlet $input = $wrapper.querySelector(selectors.input);\n\t\t\tlet focusDescendantId = $input.getAttribute('aria-activedescendant');\n\n\t\t\tif (focusDescendantId) {\n\t\t\t\t$focusEl = document.getElementById(focusDescendantId);\n\t\t\t}\n\n\t\t\tif (!focusDescendantId || $focusEl.length === 0) {\n\t\t\t\t$focusEl = document.activeElement;\n\t\t\t}\n\n\t\t\treturn $focusEl;\n\t\t}\n\t};\n\n\treturn {\n\t\tinit: module.init\n\t};\n})(templayed, debounce, activate, publish);\n\nexport default autocomplete;\n","import autocomplete from './autocomplete.js';\n\nautocomplete.init();\n"],"sourceRoot":""}