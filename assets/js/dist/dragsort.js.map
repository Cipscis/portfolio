{"version":3,"file":"dragsort.js","mappings":"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","sources":["webpack://@cipscis/portfolio/./node_modules/@cipscis/pubsub/dist/pubsub.js","webpack://@cipscis/portfolio/./app/assets/js/src/dragsort/dragsort.js"],"sourcesContent":["const subscriptions = {};\r\n// Split by whitespace, then remove any empty strings\r\nconst split = (eventString) => eventString.split(/\\s+/).filter(str => !!str);\r\nconst publish = function (event, ...args) {\r\n    const events = split(event);\r\n    if (events.length > 1) {\r\n        for (const event of events) {\r\n            publish.call(this, event, ...args);\r\n        }\r\n    }\r\n    else if (event in subscriptions) {\r\n        const callbacks = subscriptions[event];\r\n        callbacks.forEach((callback) => {\r\n            callback.apply(null, args);\r\n        });\r\n    }\r\n};\r\nconst subscribe = function (event, callback) {\r\n    const events = split(event);\r\n    if (events.length > 1) {\r\n        for (const event of events) {\r\n            subscribe(event, callback);\r\n        }\r\n    }\r\n    else {\r\n        if (!(event in subscriptions)) {\r\n            subscriptions[event] = [];\r\n        }\r\n        const callbacks = subscriptions[event];\r\n        // Don't bind a particular function to an event more than once\r\n        if (callbacks.includes(callback) === false) {\r\n            callbacks.push(callback);\r\n        }\r\n    }\r\n};\r\nconst unsubscribe = function (event, callback) {\r\n    if (event in subscriptions) {\r\n        const callbacks = subscriptions[event];\r\n        const index = callbacks.indexOf(callback);\r\n        if (index !== -1) {\r\n            callbacks.splice(index, 1);\r\n        }\r\n    }\r\n};\r\nexport { publish, subscribe, unsubscribe };\r\n//# sourceMappingURL=pubsub.js.map","/* Drag/Sort 1.0 */\n\nimport { publish } from '@cipscis/pubsub';\n\n// Can work with or without a pubsub implementation\nconst dragsort = (function (publish) {\n\tlet $draggedEl;\n\tlet $clone;\n\tlet $dropTarget;\n\tlet dropDepth = 0;\n\n\tlet cloneOffsetX;\n\tlet cloneOffsetY;\n\n\t// https://stackoverflow.com/questions/21825157/internet-explorer-11-detection\n\tconst isIE11 = !!window.MSInputMethodContext && !!document.documentMode;\n\tconst isSafari = (navigator.userAgent.indexOf('Safari') !== -1) && (navigator.userAgent.indexOf('Chrome') === -1);\n\n\t// IE11 basically just breaks if you try to do anything fancy\n\t// Safari breaks if you try to set a drag image\n\tconst fullSupport = !(isIE11 || isSafari);\n\tlet useClone = fullSupport;\n\n\tconst selectors = {\n\t\tlist: '.js-dragsort__list',\n\t\twrap: '.js-dragsort__wrap',\n\t\titem: '.js-dragsort__item',\n\t\thandle: '.js-dragsort__handle',\n\t};\n\n\tconst classes = {\n\t\tdragging: 'is-dragging',\n\t\tdroppable: 'is-droppable',\n\n\t\tclone: 'is-clone',\n\n\t\tfullSupport: 'dragsort-full',\n\t};\n\n\tconst events = {\n\t\tdragStart: '/dragsort/start',\n\t\tdragStop: '/dragsort/stop',\n\t};\n\n\tconst module = {\n\t\tinit: function () {\n\t\t\tmodule._initEvents();\n\n\t\t\tif (fullSupport) {\n\t\t\t\tdocument.querySelector('html').classList.add(classes.fullSupport);\n\t\t\t}\n\t\t},\n\n\t\t_initEvents: function () {\n\t\t\tdocument.querySelectorAll(selectors.handle).forEach((el) => el.addEventListener('dragstart', module._processDragStart));\n\t\t\tdocument.querySelectorAll(selectors.item).forEach((el) => el.addEventListener('dragenter', module._processDragEnter));\n\t\t\tdocument.querySelectorAll(selectors.item).forEach((el) => el.addEventListener('dragleave', module._processDragLeave));\n\t\t\tdocument.querySelectorAll(selectors.item).forEach((el) => el.addEventListener('dragover', module._processDragOver));\n\t\t\tdocument.querySelectorAll(selectors.item).forEach((el) => el.addEventListener('drop', module._processDrop));\n\t\t\tdocument.querySelectorAll(selectors.item).forEach((el) => el.addEventListener('dragend', module._processDragEnd));\n\t\t},\n\n\t\t_processDragStart: function (e) {\n\t\t\tlet $target = e.target;\n\t\t\tlet $item = $target.closest(selectors.item);\n\t\t\tlet dataTransfer = e.dataTransfer;\n\t\t\tlet dragImage = new Image();\n\n\t\t\tif (!($target.matches('[draggable=\"true\"]') || $target.closest('[draggable=\"true\"]').closest(selectors.item) === $item)) {\n\t\t\t\t// Only start dragging draggable items\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdataTransfer.dropEffect = 'move';\n\t\t\tif (useClone) {\n\t\t\t\tif (!dataTransfer.setDragImage) {\n\t\t\t\t\tuseClone = false;\n\t\t\t\t} else {\n\t\t\t\t\t// Hide image to use clone\n\t\t\t\t\tdragImage.src = '';\n\t\t\t\t\tdataTransfer.setDragImage(dragImage, 0, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Some data is required for Firefox\n\t\t\tdataTransfer.setData('Text', '');\n\n\t\t\tmodule._startDragging($item, e);\n\t\t},\n\n\t\t_processDragEnter: function (e) {\n\t\t\tlet $target = e.target;\n\n\t\t\tif ($target instanceof Text) {\n\t\t\t\t// Ignore text nodes\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet $item = e.target.closest(selectors.item);\n\t\t\tlet $wrap = $draggedEl.closest(selectors.wrap);\n\n\t\t\tif ($wrap.length === 0) {\n\t\t\t\t$wrap = $item;\n\t\t\t}\n\t\t\tlet padding = getComputedStyle($wrap).height;\n\n\t\t\tif ($item === $dropTarget) {\n\t\t\t\tdropDepth += 1;\n\t\t\t} else if (\n\t\t\t\t// If it's another element in the list and isn't marked as \"droppable\"\n\t\t\t\t($item.closest(selectors.list) === $draggedEl.closest(selectors.list)) &&\n\t\t\t\t($item.classList.contains(classes.droppable) === false)\n\t\t\t) {\n\t\t\t\tif ($item === $draggedEl) {\n\t\t\t\t\tmodule._clearDropTarget();\n\t\t\t\t} else {\n\t\t\t\t\t$item.classList.add(classes.droppable);\n\n\t\t\t\t\tmodule._setDropTarget($item);\n\n\t\t\t\t\tif ($draggedEl.compareDocumentPosition($item) === 4) { // DOCUMENT_POSITION_FOLLOWING\n\t\t\t\t\t\t$item.style.paddingBottom = padding;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$item.style.paddingTop = padding;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_processDragLeave: function (e) {\n\t\t\tlet $target = e.target;\n\n\t\t\tif ($target === $dropTarget) {\n\t\t\t\tdropDepth -= 1;\n\n\t\t\t\tif (dropDepth <= 0) {\n\t\t\t\t\tmodule._clearDropTarget();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_processDragOver: function (e) {\n\t\t\t// Prevent default in this event to allow drag and drop\n\t\t\te.dataTransfer.dropEffect = 'move';\n\n\t\t\tlet $target = e.target.closest(selectors.item);\n\n\t\t\t// Can't drag an element onto itself\n\t\t\tif ($target !== $draggedEl) {\n\t\t\t\t// Can't drag an element outside its list\n\t\t\t\tif ($target.closest(selectors.list) === $draggedEl.closest(selectors.list)) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_processDrop: function (e) {\n\t\t\tlet $drop = e.target.closest(selectors.item);\n\t\t\tlet $dropWrap = $drop.closest(selectors.wrap);\n\n\t\t\tlet $drag = $draggedEl;\n\t\t\tlet $dragWrap = $drag.closest(selectors.wrap);\n\n\t\t\t// Allow wrapping elements to be moved, for layout purposes\n\t\t\tif ($dropWrap) {\n\t\t\t\t$drop = $dropWrap;\n\t\t\t}\n\t\t\tif ($dragWrap) {\n\t\t\t\t$drag = $dragWrap;\n\t\t\t}\n\n\t\t\tif ($drag.compareDocumentPosition($drop) === 4) { // DOCUMENT_POSITION_FOLLOWING\n\t\t\t\t$drop.parentNode.insertBefore($drag, $drop.nextSibling);\n\t\t\t} else {\n\t\t\t\t$drop.parentNode.insertBefore($drag, $drop);\n\t\t\t}\n\t\t},\n\n\t\t_processDragEnd: function (e) {\n\t\t\tmodule._stopDragging();\n\t\t},\n\n\t\t_startDragging: function ($el, e) {\n\t\t\tlet $list = $el.closest(selectors.list);\n\n\t\t\tif (publish) {\n\t\t\t\tpublish(events.dragStart, $list);\n\t\t\t}\n\n\t\t\t$draggedEl = $el;\n\t\t\tmodule._createClone($el, e);\n\n\t\t\t$el.classList.add(classes.dragging);\n\t\t\t$list.classList.add(classes.dragging);\n\t\t},\n\n\t\t_stopDragging: function () {\n\t\t\tlet $list = $draggedEl.closest(selectors.list);\n\n\t\t\t$draggedEl.classList.remove(classes.dragging);\n\t\t\t$list.classList.remove(classes.dragging);\n\t\t\t$draggedEl = null;\n\n\t\t\tmodule._destroyClone();\n\t\t\tmodule._clearDropTarget();\n\n\t\t\tif (publish) {\n\t\t\t\tpublish(events.dragStop, $list);\n\t\t\t}\n\t\t},\n\n\t\t_clearDropTarget: function () {\n\t\t\tlet $droppable = document.querySelectorAll('.' + classes.droppable);\n\n\t\t\t$droppable.forEach((el) => {\n\t\t\t\tel.classList.remove(classes.droppable);\n\t\t\t\tel.style.padding = 0;\n\t\t\t});\n\n\t\t\t$dropTarget = null;\n\t\t\tdropDepth = 0;\n\t\t},\n\n\t\t_setDropTarget: function ($target) {\n\t\t\tmodule._clearDropTarget();\n\n\t\t\t$dropTarget = $target;\n\t\t\tdropDepth = 1;\n\t\t\t$dropTarget.classList.add(classes.droppable);\n\t\t},\n\n\t\t// Clone\n\t\t_createClone: function ($el, e) {\n\t\t\tif (useClone) {\n\t\t\t\t$clone = $el.cloneNode(true);\n\n\t\t\t\tlet style = getComputedStyle($el);\n\n\t\t\t\tlet width = style.width;\n\t\t\t\tlet height = style.height;\n\n\t\t\t\tlet pos = $el.getBoundingClientRect();\n\t\t\t\tlet x = pos.x || pos.left;\n\t\t\t\tlet y = pos.y || pos.top;\n\n\t\t\t\tcloneOffsetX = e.clientX - x;\n\t\t\t\tcloneOffsetY = e.clientY - y;\n\n\t\t\t\t$clone.style.width = width;\n\t\t\t\t$clone.style.height = height;\n\n\t\t\t\t// Prevent issues with moving elements containing selected radio buttons\n\t\t\t\t$clone.querySelectorAll('[type=\"radio\"][name]').forEach((el) => el.removeAttribute('name'));\n\n\t\t\t\tdocument.querySelector('body').appendChild($clone);\n\t\t\t\t$clone.classList.add(classes.clone);\n\n\t\t\t\tmodule._initCloneEvents();\n\n\t\t\t\tmodule._updateClonePosition(e);\n\t\t\t}\n\t\t},\n\n\t\t_destroyClone: function () {\n\t\t\tif (useClone) {\n\t\t\t\tif ($clone) {\n\t\t\t\t\t$clone.remove();\n\t\t\t\t}\n\t\t\t\tmodule._uninitCloneEvents();\n\n\t\t\t\t$clone = null;\n\t\t\t\tcloneOffsetX = null;\n\t\t\t\tcloneOffsetY = null;\n\t\t\t}\n\t\t},\n\n\t\t_initCloneEvents: function () {\n\t\t\tdocument.querySelector('body').addEventListener('dragover', module._updateClonePosition);\n\t\t},\n\t\t_uninitCloneEvents: function () {\n\t\t\tdocument.querySelector('body').removeEventListener('dragover', module._updateClonePosition);\n\t\t},\n\n\t\t_updateClonePosition: function (e) {\n\t\t\tlet x = e.clientX - cloneOffsetX;\n\t\t\tlet y = e.clientY - cloneOffsetY;\n\n\t\t\t$clone.style.left = x;\n\t\t\t$clone.style.top = y;\n\t\t},\n\t};\n\n\treturn {\n\t\tinit: module.init,\n\t};\n\n})(publish);\n\n// Self-initialise\ndragsort.init();\n\nexport default dragsort;\n"],"names":["subscriptions","publish","event","args","events","split","filter","str","length","call","this","forEach","callback","apply","dragsort","$draggedEl","$clone","$dropTarget","cloneOffsetX","cloneOffsetY","dropDepth","isIE11","window","MSInputMethodContext","document","documentMode","isSafari","navigator","userAgent","indexOf","fullSupport","useClone","selectors","classes","module","init","_initEvents","querySelector","classList","add","querySelectorAll","el","addEventListener","_processDragStart","_processDragEnter","_processDragLeave","_processDragOver","_processDrop","_processDragEnd","e","$target","target","$item","closest","dataTransfer","dragImage","Image","matches","dropEffect","setDragImage","src","setData","_startDragging","Text","$wrap","padding","getComputedStyle","height","contains","_clearDropTarget","_setDropTarget","compareDocumentPosition","style","paddingBottom","paddingTop","preventDefault","$drop","$dropWrap","$drag","$dragWrap","parentNode","insertBefore","nextSibling","_stopDragging","$el","$list","_createClone","remove","_destroyClone","cloneNode","width","pos","getBoundingClientRect","x","left","y","top","clientX","clientY","removeAttribute","appendChild","_initCloneEvents","_updateClonePosition","_uninitCloneEvents","removeEventListener"],"sourceRoot":""}