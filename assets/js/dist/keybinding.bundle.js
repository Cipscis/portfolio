(()=>{"use strict";const e=function(){const e={},n={_isFocusOnInput:function(){let e=document.activeElement,n=e.nodeName.toLowerCase(),t=["input","textarea","select"].includes(n);if("input"===n){let n=e.attributes.type.value.toLowerCase();["color","radio","checkbox"].includes(n)&&(t=!1)}else e.isContentEditable&&(t=!0);return t},_bindFn:function(n,t,i){document.addEventListener("keydown",i),e[n]||(e[n]=[]),e[n].push({fn:t,fnWrapper:i})},bind:function(e,t,i,o){if("string"!=typeof e)throw new TypeError("The key parameter to bind must be a string.");e=e.toLowerCase(),n._bindFn(e,t,(function(r){(i||!n._isFocusOnInput()||o)&&r.key&&r.key.toLowerCase()===e&&(o&&!r.ctrlKey||!1===t.apply(this,arguments)&&(r.preventDefault(),r.stopPropagation()))}))},unbind:function(n,t){let i=e[n];if(i){let e;for(e=0;e<i.length&&i[e].fn!==t;e++);e<i.length&&(document.removeEventListener("keydown",i[e].fnWrapper),i.splice(e,1))}},rebind:function(e,t,i,o,r){n.unbind(e,t),n.bind(i,t,o,r)},_getSequenceArgs:function(e,n,t,i){let o=Array.prototype.splice.call(arguments,0),r=o[0];return i=o[o.length-1],Array.isArray(r)||(r=o.splice(0,o.length-1)),{keys:r,fn:i}},bindSequence:function(e,t,i,o){let r=n._getSequenceArgs.apply(this,arguments),a=r.keys,d=[];if(o=r.fn,a.length>1){let e=function(e){let t=e.key.toLowerCase();if(!n._isFocusOnInput()&&("shift"!==t&&d.push(t),d.length>a.length&&d.shift(),t===a[a.length-1])){let n;for(n=0;n<a.length&&a[n]===d[n];n++);n===a.length&&!1===o.apply(this,arguments)&&(e.preventDefault(),e.stopPropagation())}},t=a.join(",");n._bindFn(t,o,e)}},unbindSequence:function(e,t,i,o){let r=n._getSequenceArgs.apply(this,arguments),a=r.keys.join(",");o=r.fn,n.unbind(a,o)},rebindSequence:function(e,t,i){n.unbindSequence(e,t),n.bindSequence(i,t)}};return{bind:n.bind,unbind:n.unbind,rebind:n.rebind,bindSequence:n.bindSequence,unbindSequence:n.unbindSequence,rebindSequence:n.rebindSequence}}(),n=[],{activate:t,deactivate:i}=function(){const e={activate:function(n,t){e._activator(n,t,e._activateSingle)},deactivate:function(n,t){e._activator(n,t,e._deactivateSingle)},_activator:function(n,t,i){if("string"==typeof n)try{n=document.querySelectorAll(n)}catch(t){let o=i===e._deactivateSingle?"deactivate":"activate";throw new DOMException(`${o} failed because it was passed an invalid selector string: '${n}'`)}n instanceof Node?i(n,t):n.length&&n.forEach&&n.forEach((e=>i(e,t)))},_activateSingle:function(n,t){if(n instanceof Node==0)throw new TypeError("activate failed because a valid Node was not passed");if(!e._getNodeBindings(n,t)&&(n.addEventListener("click",t),!1===e._isNodeType(n,"button"))){!1===e._getNodeHasBindings(n)&&n.addEventListener("keydown",e._preventSpacebarScroll);let i=e._makeSpacebarFn(t);n.addEventListener("keyup",i);let o={spacebarFn:i};if(!1===e._isNodeType(n,"a")){let i=e._makeEnterFn(t);n.addEventListener("keydown",i),o.enterFn=i}e._rememberNodeBindings(n,t,o)}},_deactivateSingle:function(n,t){if(n instanceof Node==0)throw new TypeError("deactivate failed because a valid Node was not passed");let i=e._getNodeBindings(n,t);n.removeEventListener("click",t),i&&!1===e._isNodeType(n,"button")&&(n.removeEventListener("keyup",i.spacebarFn),!1===e._isNodeType(n,"a")&&n.removeEventListener("keydown",i.enterFn),e._forgetNodeBindings(n,t),!1===e._getNodeHasBindings(n)&&n.removeEventListener("keydown",e._preventSpacebarScroll))},_rememberNodeBindings:function(e,t,i){let o=n.find((n=>n.node===e));o||(o={node:e,bindings:[{fn:t}]},n.push(o));let r=o.bindings.find((e=>e.fn===t));r||(r={fn:t},o.bindings.push(r)),Object.assign(r,i)},_forgetNodeBindings:function(e,t){let i=n.find((n=>n.node===e));if(!i)return;let o=i.bindings.find((e=>e.fn===t));if(!o)return;let r=i.bindings.indexOf(o);i.bindings.splice(r,1)},_getNodeBindings:function(e,t){let i=n.find((n=>n.node===e));if(i)return i.bindings.find((e=>e.fn===t))||void 0},_getNodeHasBindings:function(e){return!!n.find((n=>n.node===e))},_makeEnterFn:function(n){return function(t){let i=e._isEnter(t);i&&n.apply(this,arguments)}},_isEnter:function(e){return e.key&&"enter"===e.key.toLowerCase()},_preventSpacebarScroll:function(n){let t=n.target,i=e._isNodeType(t,"button"),o=e._isNodeType(t,"input","textarea"),r=e._isSpacebar(n);i||o||!r||n.preventDefault()},_makeSpacebarFn:function(n){return function(t){let i=e._isSpacebar(t);i&&n.apply(this,arguments)}},_isSpacebar:function(e){return e.key&&(" "===e.key||"spacebar"===e.key.toLowerCase())},_isNodeType:function(e,...n){n=n.map((e=>e.toLowerCase()));let t=e.nodeName.toLowerCase();return n.includes(t)}};return{activate:e.activate,deactivate:e.deactivate}}();!function(e,n){const t=function(e){return function(n){n.preventDefault(),document.querySelectorAll(".js-text-message")[0].textContent=e}},i=["arrowup","arrowup","arrowdown","arrowdown","arrowleft","arrowright","arrowleft","arrowright","b","a","enter"],o=t("Hey, stop cheating!");e.bind("a",t("You pressed the 'a' key")),e.bind("m",t("You pressed Ctrl + 'm'"),!0,!0),e.bindSequence(i,o),n(document.querySelectorAll(".js-unbind-sequence")[0],(function(n){e.unbindSequence(i,o)}));const r=t("You pressed the 'k' key");n(document.querySelectorAll(".js-bind")[0],(function(n){e.bind("k",r)})),n(document.querySelectorAll(".js-unbind")[0],(function(n){e.unbind("k",r)}))}(e,t)})();
//# sourceMappingURL=keybinding.bundle.js.map